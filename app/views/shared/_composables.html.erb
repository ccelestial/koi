<%- data.each do |section| -%>

  <%- # Build mark up for the data inside this section for use later -%>
  <%- section_contents = capture do -%>
    <%- section[:section_data].each do |datum| -%>
      <%- datum_type = datum["type"] -%>
      <%= 
        begin
          render "shared/composable_components/#{datum_type}", data: datum 
        rescue ActionView::MissingTemplate
          "Unknown component type: #{datum_type}"
        end
      -%>
    <%- end -%>
  <%- end -%>

  <%- # Build markup for our section and insert our data -%>
  <%- section_type = section[:section_type] -%>
  <%= 
    begin
      render "shared/composable_sections/#{section_type}", section: section, section_contents: section_contents 
    rescue ActionView::MissingTemplate
      render "shared/composable_sections/default", section: section, section_contents: section_contents 
    end
  -%>

<%- end -%>
